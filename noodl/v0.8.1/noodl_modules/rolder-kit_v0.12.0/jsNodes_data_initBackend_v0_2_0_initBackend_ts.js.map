{"version":3,"file":"jsNodes_data_initBackend_v0_2_0_initBackend_ts.js","sources":["./jsNodes/data/initBackend/v0.2.0/initBackend.ts","./libs/kuzzle/v.0.2.0/init.ts"],"sourcesContent":["import { NodeInstance } from \"@noodl/noodl-sdk\"\nimport init from \"../../../../libs/kuzzle/v.0.2.0/init\"\nimport validateJwt from \"../../../../libs/validateJwt/v0.1.0/validateJwt\"\n\nexport default async function initBackend_v0_2_0(noodlNode: NodeInstance) {\n    const { project, envVersion, debug } = window.Rolder\n\n    if (debug > 1) console.time('Initialize performance')\n    const Kuzzle = init({ project, envVersion })\n    Kuzzle.connect().then(() => {\n        window.Kuzzle = Kuzzle\n        if (debug > 0) console.log('Kuzzle initialized: ' + project + '-' + envVersion)\n        if (debug > 1) console.timeEnd('Initialize performance')\n        validateJwt().then((jwtValid) => {\n            if (jwtValid) {\n                noodlNode.sendSignalOnOutput('jwtValidationSucceed')\n                Kuzzle?.auth.getCurrentUser().then((res: any) => noodlNode.setOutputs({userRole: res.content.role?.value})                    )\n            } else noodlNode.sendSignalOnOutput('jwtValidationFailed')\n        })\n    }).catch((error: any) => {\n        console.error(error.message)\n    })\n}","import { Kuzzle, WebSocket } from 'kuzzle-sdk'\n\nexport default function init(props: { project: string, envVersion: string }): Kuzzle {\n    return new Kuzzle(\n        new WebSocket(`${props.project}.kuzzle.${props.envVersion}.rolder.app`, { port: 443 })//, { cookieAuth: true }\n    )\n}"],"names":["initBackend_v0_2_0","noodlNode","project","envVersion","debug","window","Rolder","console","time","Kuzzle","connect","then","log","timeEnd","jwtValid","sendSignalOnOutput","auth","getCurrentUser","res","setOutputs","userRole","content","role","value","catch","error","message","init","props","WebSocket","port"],"mappings":"yOAIe,eAAeA,EAAmBC,CAAuB,EACpE,GAAM,CAAEC,QAAAA,CAAO,CAAEC,WAAAA,CAAU,CAAEC,MAAAA,CAAK,CAAE,CAAGC,OAAOC,MAAM,CAEhDF,EAAQ,GAAGG,QAAQC,IAAI,CAAC,0BAC5B,IAAMC,EAAS,cAAK,CAAEP,QAAAA,EAASC,WAAAA,CAAW,GAC1CM,EAAOC,OAAO,GAAGC,IAAI,CAAC,KAClBN,OAAOI,MAAM,CAAGA,EACZL,EAAQ,GAAGG,QAAQK,GAAG,CAAC,uBAAyBV,EAAU,IAAMC,GAChEC,EAAQ,GAAGG,QAAQM,OAAO,CAAC,0BAC/B,gBAAcF,IAAI,CAAC,AAACG,IACZA,GACAb,EAAUc,kBAAkB,CAAC,wBAC7BN,GAAQO,KAAKC,iBAAiBN,KAAK,AAACO,GAAajB,EAAUkB,UAAU,CAAC,CAACC,SAAUF,EAAIG,OAAO,CAACC,IAAI,EAAEC,KAAK,KACrGtB,EAAUc,kBAAkB,CAAC,sBACxC,EACJ,GAAGS,KAAK,CAAC,AAACC,IACNlB,QAAQkB,KAAK,CAACA,EAAMC,OAAO,CAC/B,EACJ,C,qGCpBe,SAASC,EAAKC,CAA8C,EACvE,OAAO,IAAI,EAAAnB,MAAM,CACb,IAAI,EAAAoB,SAAS,CAAC,CAAC,EAAED,EAAM1B,OAAO,CAAC,QAAQ,EAAE0B,EAAMzB,UAAU,CAAC,WAAW,CAAC,CAAE,CAAE2B,KAAM,GAAI,GAE5F,C"}