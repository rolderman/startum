(self.webpackChunkrolder_kit=self.webpackChunkrolder_kit||[]).push([["jsNodes_data_mutate_sUpdate_v0_v0_2_0_sUpdate_ts"],{153620:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return n}});var u=a("123418"),r=a("666767"),d=a("550277"),n={update:e=>{let{updateScheme:t,optimistic:a}=e._inputValues;(0,d.sendOutput)(e,"updating",!0);let n=e=>(0,u.default)(e,a),l=e=>(0,r.default)(e,a);t&&Promise.all(t.map(e=>"user"===e.dbClass?l(e):n(e))).then(t=>{(0,d.sendOutput)(e,"updatedData",t),(0,d.sendSignal)(e,"updated"),(0,d.sendOutput)(e,"updating",!1)})}}},501194:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return function e(t){let a={};if(t&&"object"==typeof t)return(0,r.default)(t,(t,r)=>{if("object"!=typeof r||Array.isArray(r))Array.isArray(r)?r.forEach(u=>{let r=e(u);r?.length&&(a[t]=a[t]?[...a[t],r]:[r])}):r&&(a[t]=r);else if(!(0,u.default)(r)){let d=e(r);!(0,u.default)(d)&&(a[t]=d)}}),a;if(t)return t;if(Array.isArray(t))throw Error(`It is array, object expected: ${t}`)}}});var u=a("939711"),r=a("309317")},123418:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var u=a("516244"),r=a("995929"),d=a("650887"),n=a("687803"),l=a("501194"),s=a("528957");let i=async(e,t)=>{let a;let{Kuzzle:i}=window,{dbClass:c,id:f,body:o}=e,p=(0,d.setOptions)(c),h=(0,n.dbClassVersion)(c),y=(0,l.default)(o);return(0,u.default)(`${h} update`,"time"),(0,u.default)([`${h} props: `,{dbClass:c,id:f,flushedBody:y,options:p}]),t&&(a=s.default(c,[{id:f,...y}])?.[0]),i.connect().then(()=>i.document.update((0,n.dbVersion)(),h,f,y,p).then(()=>((0,u.default)([`${h} updated: `,a]),(0,u.default)(`${h} update`,"timeEnd"),!t&&(a=s.default(c,[{id:f,...y}])?.[0]),a)).catch(e=>(0,r.default)({title:"Системная ошибка!",message:"Kuzzle update "+h+": "+e.message})))};var c=i},666767:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var u=a("516244"),r=a("995929"),d=a("650887"),n=a("501194"),l=a("528957");let s=async(e,t)=>{let{Kuzzle:a}=window,{id:s,body:i}=e,c=(0,d.setOptions)("user"),f=(0,n.default)(i),o={};t&&(o=l.default("user",[{id:s,...f}])?.[0]);let p={...i.content,credentials:{local:{notSecret:i.credentials?.local.notSecret}}};return(0,u.default)("UpdateUser","time"),(0,u.default)(["Props: ",{id:s,flushedBody:f,options:c}]),a.connect().then(()=>a.security.updateCredentials("local",s,i.credentials?.local).then(()=>a.security.updateUser(s,p,c).then(()=>(!t&&(o=l.default("user",[{id:s,...f}])?.[0]),o))).catch(e=>(0,r.default)({title:"Системная ошибка!",message:"Kuzzle updateUser : "+e.message})))};var i=s}}]);
//# sourceMappingURL=jsNodes_data_mutate_sUpdate_v0_v0_2_0_sUpdate_ts.js.map