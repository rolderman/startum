{"version":3,"file":"jsNodes_data_mUpdateUser_v0_v0_1_0_mUpdateUser_ts.js","sources":["./jsNodes/data/mUpdateUser/v0/v0.1.0/mUpdateUser.ts","./libs/kuzzle/updateUser/v0.1.0/updateUser.ts"],"sourcesContent":["import { sendOutput, sendSignal } from \"../../../../../utils/noodl/v0.1.0/send\"\nimport updateUser from \"../../../../../libs/kuzzle/updateUser/v0.1.0/updateUser\"\n\ntype UserItem = {\n    id: string\n    body: any\n    options?: any\n}\n\nconst signals = {\n    mUpdateUser: (noodlNode: NodeInstance) => {\n        const { userItems }: { userItems: UserItem[] } = noodlNode._inputValues\n        sendOutput({ noodlNode, portName: 'updating', value: true })\n        Promise.all(userItems.map(i => updateUser(i.id, i.body, { refresh: 'wait_for' })))\n\n        sendSignal({ noodlNode, portName: 'updated' })\n        sendOutput({ noodlNode, portName: 'updating', value: false })\n    }\n}\n\nexport default signals","import conLog from '../../../../utils/debug/conLog/v0.1.0/conLog'\nimport ErrorHandler from '../../../errorHandler/v0.1.0/ErrorHandler'\n\nconst updateUser = async (id: string, body: any, options?: Options) => {\n    const Kuzzle = window.Kuzzle\n\n    conLog(`UpdateUser`, 'time')\n    conLog([`Props: `, { id, body, options }])\n\n    return Kuzzle.connect().then(() =>\n        Kuzzle.security.updateCredentials('local', id, body.credentials.local)\n            .then(() => Kuzzle.security.updateUser(id, body, options))\n            .catch((error: any) => ErrorHandler({ title: 'Системная ошибка!', message: 'Kuzzle updateUser ' + ': ' + error.message }))\n    )\n}\n\nexport default updateUser"],"names":["mUpdateUser","noodlNode","userItems","_inputValues","sendOutput","portName","value","Promise","all","map","i","id","body","refresh","sendSignal","updateUser","options","Kuzzle","window","connect","then","security","updateCredentials","credentials","local","catch","error","title","message"],"mappings":"4OAoBA,EAXgB,CACZA,YAAa,AAACC,IACV,GAAM,CAAEC,UAAAA,CAAS,CAAE,CAA8BD,EAAUE,YAAY,CACvE,KAAAC,UAAA,EAAW,CAAEH,UAAAA,EAAWI,SAAU,WAAYC,MAAO,EAAK,GAC1DC,QAAQC,GAAG,CAACN,EAAUO,GAAG,CAAC,AAAAC,GAAK,cAAWA,EAAEC,EAAE,CAAED,EAAEE,IAAI,CAAE,CAAEC,QAAS,UAAW,KAE9E,KAAAC,UAAA,EAAW,CAAEb,UAAAA,EAAWI,SAAU,SAAU,GAC5C,KAAAD,UAAA,EAAW,CAAEH,UAAAA,EAAWI,SAAU,WAAYC,MAAO,EAAM,EAC/D,CACJ,C,mHCfA,IAAMS,EAAa,MAAOJ,EAAYC,EAAWI,KAC7C,IAAMC,EAASC,OAAOD,MAAM,CAK5B,MAHA,cAAO,aAAc,QACrB,cAAO,CAAC,UAAW,CAAEN,GAAAA,EAAIC,KAAAA,EAAMI,QAAAA,CAAQ,EAAE,EAElCC,EAAOE,OAAO,GAAGC,IAAI,CAAC,IACzBH,EAAOI,QAAQ,CAACC,iBAAiB,CAAC,QAASX,EAAIC,EAAKW,WAAW,CAACC,KAAK,EAChEJ,IAAI,CAAC,IAAMH,EAAOI,QAAQ,CAACN,UAAU,CAACJ,EAAIC,EAAMI,IAChDS,KAAK,CAAC,AAACC,GAAe,cAAa,CAAEC,MAAO,oBAAqBC,QAAS,uBAA8BF,EAAME,OAAO,AAAC,IAEnI,EAEA,MAAeb,C"}