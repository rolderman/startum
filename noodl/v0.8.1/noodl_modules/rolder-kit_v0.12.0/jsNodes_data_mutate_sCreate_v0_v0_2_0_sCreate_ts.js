(self.webpackChunkrolder_kit=self.webpackChunkrolder_kit||[]).push([["jsNodes_data_mutate_sCreate_v0_v0_2_0_sCreate_ts"],{614056:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var a=r("786552"),l=r("550277"),n=r("860976"),u=r("895229"),s={create:e=>{let{createScheme:t}=e._inputValues;(0,l.sendOutput)(e,"creating",!0);let r=(0,a.default)(t.map(e=>e.order)).sort(),s=e=>(0,n.default)(e),c=e=>(0,u.default)(e),d=r.map(e=>t.filter(t=>t.order===e));(async function t(){let t={};for(let e of d){let r=await Promise.all(e.map(e=>{let r=e.references;return(r&&r.forEach(r=>e.body[r]={...e.body[r],id:t[r]?.id}),"user"===e.dbClass)?c(e):s(e)}));e.forEach((e,a)=>t[e.dbClass]=r[a])}(0,l.sendOutput)(e,"createdData",t),(0,l.sendSignal)(e,"created"),(0,l.sendOutput)(e,"creating",!1)})().catch(e=>console.error(e))}}},501194:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return function e(t){let r={};if(t&&"object"==typeof t)return(0,l.default)(t,(t,l)=>{if("object"!=typeof l||Array.isArray(l))Array.isArray(l)?l.forEach(a=>{let l=e(a);l?.length&&(r[t]=r[t]?[...r[t],l]:[l])}):l&&(r[t]=l);else if(!(0,a.default)(l)){let n=e(l);!(0,a.default)(n)&&(r[t]=n)}}),r;if(t)return t;if(Array.isArray(t))throw Error(`It is array, object expected: ${t}`)}}});var a=r("939711"),l=r("309317")},860976:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var a=r("516244"),l=r("995929"),n=r("650887"),u=r("850577"),s=r("724830"),c=r("501194"),d=r("491929"),o=r("687803");let f=async e=>{let{Kuzzle:t}=window,{dbClass:r,body:f}=e,i=(0,n.setOptions)(r),p=(0,o.dbClassVersion)(r),h=(0,c.default)(f);return(0,a.default)(`${p} create`,"time"),(0,a.default)([`${p} props: `,{dbClass:r,body:f,options:i}]),t.connect().then(()=>t.document.create((0,o.dbVersion)(),p,h,null,i).then(e=>{let t=s.default([e])?.[0],l=(0,u.default)(r,t);return(0,d.default)(r),(0,a.default)([`${p} created: `,l]),(0,a.default)(`${p} create`,"timeEnd"),l}).catch(e=>(0,l.default)({title:"Системная ошибка!",message:"Kuzzle create "+p+": "+e.message})))};var i=f},895229:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var a=r("516244"),l=r("995929"),n=r("850577"),u=r("724830"),s=r("501194"),c=r("491929");let d=async e=>{let{Kuzzle:t}=window,{body:r}=e,d={refresh:"wait_for"},o=(0,s.default)(r),f={...o.content,credentials:{local:{notSecret:o.credentials?.local.notSecret}}},i=o.credentials;return delete i?.local.notSecret,(0,a.default)("CreateUser","time"),(0,a.default)(["CreateUser props: ",{content:f,credentials:i}]),t.connect().then(()=>t.security.createUser(null,{content:f,credentials:i},d).then(e=>{e._source.credentials.local.username=i.local.username;let t=u.convertKUser([e])?.[0],r=(0,n.default)("user",t);return(0,c.default)("user"),(0,a.default)(["CreateUser: ",r]),(0,a.default)("CreateUser","timeEnd"),r}).catch(e=>(0,l.default)({title:"Системная ошибка!",message:"Kuzzle createUser : "+e.message})))};var o=d}}]);
//# sourceMappingURL=jsNodes_data_mutate_sCreate_v0_v0_2_0_sCreate_ts.js.map